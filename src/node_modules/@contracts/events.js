import { contractInfo } from "@storage/contract";
import { createEventDispatcher } from 'svelte';

//EVENT HANDLER
export async function initEventListener() {

    let contractData = await contractInfo()
    await contractData.interfaces.dragon.events.Birth()
        .once('data', (event) => globEvents(event))
        .on('error', console.error);

    // await contractData.events.playGame()
    //     .once('data', (event) => globEvents(event))
    //     .on('error', console.error);

}

//SETTING EVENTS  

export async function globEvents(event) {

    if (event.event == "Birth") birthEvent(event)
    //if (event.event == "generatedRandomNumber") oracleResponse(event)
}

// DragonContract Events

async function birthEvent(event) {

    let contractData = await contractInfo()
    console.log(event)
    contractData.interfaces.dragon.events.Birth()
        .once('data', (oracle) => globEvents(oracle))
        .on('error', console.error);

}

