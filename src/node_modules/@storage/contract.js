import { writable } from 'svelte/store';
import { Moralis } from "@moralis/MoralisSvelte";
import { CoinFlipAbi } from "@contracts/coinFlipAbi";

export const contractAddress = "0x1aE6f759A02f87fe26A107ae3d80AE3Fbe3874E8";

export const balances = writable({ contract: 0,user: 0 });

export const contractInfo = async () => {

    let web3 = await Moralis.Web3.enable();
    let account = web3.currentProvider.selectedAddress;
    let contractInstance = new web3.eth.Contract(CoinFlipAbi, contractAddress, {
        from: account,
    });
    
    let contractData = {        
        webConn: web3,
        account: account,
        contractInstance:contractInstance
    } 
    return contractData

}

export const updateBalances = async (dappBalance,userBalance) => {

    balances.update(value =>{
        value = { contract: dappBalance,user: userBalance }      
        return value
    }  )  

}